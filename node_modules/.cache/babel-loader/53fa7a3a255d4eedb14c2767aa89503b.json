{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport { UdfDataType } from '../types/graphql.v2';\nimport { JSEncrypt } from './jsencrypt/jsencrypt';\nimport { doEncrypt } from './sm-crypto/sm2/index';\nexport var encrypt = function (plainText, publicKey, encryption) {\n  return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      return [2\n      /*return*/\n      , new Promise(function (resolve, reject) {\n        // 国密支持，动态引入\n        if (encryption && (encryption === null || encryption === void 0 ? void 0 : encryption.type) === 'sm2') {\n          if (!encryption.publicKey) {\n            throw new Error('未配置: encryption.publicKey');\n          }\n\n          var encrypted_1 = doEncrypt(plainText, encryption.publicKey);\n          return resolve(\"sm2:\" + encrypted_1);\n        }\n\n        var jsencrypt = new JSEncrypt({});\n        jsencrypt.setPublicKey(publicKey); // 设置公钥\n\n        var encrypted = jsencrypt.encrypt(plainText);\n\n        if (encrypted !== false) {\n          resolve(encrypted);\n        } else {\n          reject(encrypted);\n        }\n      })];\n    });\n  });\n};\nexport default function buildTree(nodes) {\n  /* nodes structure\n  [\n    {\"id\": \"1\", \"children\": [\"2\"], \"root\": true},\n    {\"id\": \"2\", \"children\": [\"3\", \"4\"], \"root\": false},\n    {\"id\": \"3\", \"children\": [], \"root\": false},\n    {\"id\": \"4\", \"children\": [], \"root\": false},\n  ]\n     转换成 ->\n  {\n    id: 1,\n    children: [\n      {\n        id: 2,\n        children: [\n          {\n            id: 3,\n            children: []\n          },\n          {\n            id: 4,\n            children: []\n          }\n        ]\n      }\n    ]\n  }\n  */\n  var rootNodes = [nodes.find(function (x) {\n    return x.root === true;\n  })];\n\n  var mapChildren = function (childId) {\n    var node = nodes.find(function (x) {\n      return x.id === childId;\n    }) || null;\n\n    if (Array.isArray(node.children) && node.children.length > 0) {\n      node.children = node.children.map(mapChildren).filter(function (node) {\n        return node !== null;\n      });\n    }\n\n    return node;\n  };\n\n  var tree = rootNodes.map(function (node) {\n    node.children = node.children.map(mapChildren).filter(function (node) {\n      return node !== null;\n    });\n    return node;\n  });\n  return tree[0];\n}\nexport var deepEqual = function (x, y) {\n  if (x === y) {\n    return true;\n  } else if (typeof x == 'object' && x != null && typeof y == 'object' && y != null) {\n    if (Object.keys(x).length != Object.keys(y).length) return false;\n\n    for (var prop in x) {\n      if (y.hasOwnProperty(prop)) {\n        if (!deepEqual(x[prop], y[prop])) return false;\n      } else return false;\n    }\n\n    return true;\n  } else return false;\n};\nexport var popupCenter = function (url, _a) {\n  var _b = _a === void 0 ? {\n    w: 585,\n    h: 649\n  } : _a,\n      w = _b.w,\n      h = _b.h; // Fixes dual-screen position                             Most browsers      Firefox\n\n\n  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  var systemZoom = width / window.screen.availWidth;\n  var left = (width - w) / 2 / systemZoom + dualScreenLeft;\n  var top = (height - h) / 2 / systemZoom + dualScreenTop;\n  var newWindow = window.open(url, '_blank', \"\\n      toolbar=no,\\n      menubar=no,\\n      scrollbars=no,\\n      resizable=no,\\n      location=no,\\n      status=no\\n      width=\" + w / systemZoom + \",\\n      height=\" + h / systemZoom + \",\\n      top=\" + top + \",\\n      left=\" + left + \"\\n      \");\n  newWindow === null || newWindow === void 0 ? void 0 : newWindow.focus();\n  return newWindow;\n};\nexport var createCssClassStyleSheet = function (className, styleSheet) {\n  var styleTag = document.createElement('style');\n  var styleText = \"\\n    .\" + className + \" {\\n      \" + styleSheet + \"\\n    }\\n  \";\n  var textNode = document.createTextNode(styleText);\n  styleTag.appendChild(textNode);\n  document.head.appendChild(styleTag);\n};\nexport var serialize = function (obj) {\n  var str = [];\n\n  for (var p in obj) if (obj.hasOwnProperty(p)) {\n    if (obj[p] !== undefined) {\n      str.push(encodeURIComponent(p) + '=' + encodeURIComponent(obj[p]));\n    }\n  }\n\n  return str.join('&');\n};\nexport var convertUdv = function (data) {\n  for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n    var item = data_1[_i];\n    var dataType = item.dataType,\n        value = item.value;\n\n    if (dataType === UdfDataType.Number) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Boolean) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Datetime) {\n      item.value = new Date(parseInt(value));\n    } else if (dataType === UdfDataType.Object) {\n      item.value = JSON.parse(value);\n    }\n  }\n\n  return data;\n};\n\nvar isNumeric = function (str) {\n  if (typeof str != 'string') return false; // we only process strings!\n\n  return (// @ts-ignore\n    !isNaN(str) && !isNaN(parseFloat(str)) // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...\n\n  ); // ...and ensure strings of whitespace fail\n};\n\nexport var convertUdvToKeyValuePair = function (data) {\n  data = data || [];\n\n  for (var _i = 0, data_2 = data; _i < data_2.length; _i++) {\n    var item = data_2[_i];\n    var dataType = item.dataType,\n        value = item.value;\n\n    if (dataType === UdfDataType.Number) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Boolean) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Datetime) {\n      item.value = isNumeric(value) ? new Date(parseInt(value)) : new Date(value);\n    } else if (dataType === UdfDataType.Object) {\n      item.value = JSON.parse(value);\n    }\n  }\n\n  var ret = {};\n\n  for (var _a = 0, data_3 = data; _a < data_3.length; _a++) {\n    var item = data_3[_a];\n    ret[item.key] = item.value;\n  }\n\n  return ret;\n};\nexport var isWechatBrowser = function () {\n  return typeof navigator !== 'undefined' && /MicroMessenger/i.test(navigator === null || navigator === void 0 ? void 0 : navigator.userAgent);\n};\nexport var isLarkBrowser = function () {\n  return typeof navigator !== 'undefined' && /Lark/i.test(navigator.userAgent);\n};\nexport var isMobileBrowser = function () {\n  return isWechatBrowser() || isLarkBrowser();\n};\nexport var formatAuthorizedResources = function (resources) {\n  return resources.map(function (resource) {\n    for (var key in resource) {\n      if (!resource[key]) {\n        delete resource[key];\n      }\n    }\n\n    return resource;\n  });\n};\nexport function generateUidKey(number) {\n  var map = [];\n\n  for (var i = 97; i < 123; i++) {\n    map.push(String.fromCharCode(i));\n  }\n\n  var arr = [];\n\n  while (number--) {\n    var rand = Math.floor(Math.random() * 16);\n    arr.push(map[rand]);\n  }\n\n  return arr.join('');\n}\nexport var xhrUpload = function (file, url) {\n  return new Promise(function (resolve, reject) {\n    var formData = new FormData();\n    formData.append('file', file, file instanceof Blob ? 'personal.jpeg' : undefined);\n    var xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = function () {\n      // 上传成功\n      if (this.readyState === 4) {\n        try {\n          var res = JSON.parse(this.responseText);\n          var code = res.code,\n              message = res.message,\n              data = res.data;\n\n          if (code !== 200) {\n            reject({\n              code: code,\n              message: message\n            });\n          }\n\n          resolve(data);\n        } catch (error) {\n          var code = 500;\n          var message = \"\\u4E0A\\u4F20\\u56FE\\u7247\\u5931\\u8D25, error = \" + error.message;\n          reject({\n            code: code,\n            message: message\n          });\n        }\n      }\n    };\n\n    xhr.open('POST', url);\n    xhr.send(formData);\n  });\n};\nexport function uploadFile(opts) {\n  var url = opts.url,\n      accept = opts.accept,\n      multiple = opts.multiple;\n  return new Promise(function (resolve, reject) {\n    var inputElem = document.createElement('input');\n    inputElem.type = 'file';\n    inputElem.accept = accept;\n    inputElem.multiple = multiple;\n\n    inputElem.onchange = function () {\n      var files = inputElem.files;\n\n      if (!multiple) {\n        var file = files[0];\n        xhrUpload(file, url).then(function (res) {\n          return resolve(res);\n        }).catch(function (error) {\n          return reject(error);\n        });\n      } else {\n        var promises = [];\n        var i = 0;\n\n        while (i < files.length) {\n          promises.push(xhrUpload(files[i], url));\n          i++;\n        }\n\n        Promise.all(promises).then(function (res) {\n          return resolve(res);\n        }).catch(function (error) {\n          return reject(error);\n        });\n      }\n    };\n\n    inputElem.click();\n  });\n}\nexport var convertKeyValueListToObject = function (data) {\n  var ret = {};\n\n  for (var _i = 0, data_4 = data; _i < data_4.length; _i++) {\n    var _a = data_4[_i],\n        key = _a.key,\n        value = _a.value;\n    ret[key] = value;\n  }\n\n  return ret;\n};\nexport var convertObjectToKeyValueList = function (data) {\n  var ret = [];\n\n  for (var _i = 0, _a = Object.keys(data); _i < _a.length; _i++) {\n    var key = _a[_i];\n    ret.push({\n      key: key,\n      value: data[key]\n    });\n  }\n\n  return ret;\n};\nexport function generateRandomString(length) {\n  if (length === void 0) {\n    length = 30;\n  }\n\n  var result = '';\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n\n  return result;\n}\nexport var pickBy = function (obj, predicate) {\n  var ret = {};\n\n  for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\n    var key = _a[_i];\n\n    if (predicate(obj[key], key)) {\n      ret[key] = obj[key];\n    }\n  }\n\n  return ret;\n};","map":{"version":3,"sources":["../../../src/lib/utils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { UdfDataType } from '../types/graphql.v2';\nimport { JSEncrypt } from './jsencrypt/jsencrypt';\nimport { doEncrypt } from './sm-crypto/sm2/index';\nexport var encrypt = function (plainText, publicKey, encryption) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        return [2 /*return*/, new Promise(function (resolve, reject) {\n                // 国密支持，动态引入\n                if (encryption && (encryption === null || encryption === void 0 ? void 0 : encryption.type) === 'sm2') {\n                    if (!encryption.publicKey) {\n                        throw new Error('未配置: encryption.publicKey');\n                    }\n                    var encrypted_1 = doEncrypt(plainText, encryption.publicKey);\n                    return resolve(\"sm2:\" + encrypted_1);\n                }\n                var jsencrypt = new JSEncrypt({});\n                jsencrypt.setPublicKey(publicKey); // 设置公钥\n                var encrypted = jsencrypt.encrypt(plainText);\n                if (encrypted !== false) {\n                    resolve(encrypted);\n                }\n                else {\n                    reject(encrypted);\n                }\n            })];\n    });\n}); };\nexport default function buildTree(nodes) {\n    /* nodes structure\n    [\n      {\"id\": \"1\", \"children\": [\"2\"], \"root\": true},\n      {\"id\": \"2\", \"children\": [\"3\", \"4\"], \"root\": false},\n      {\"id\": \"3\", \"children\": [], \"root\": false},\n      {\"id\": \"4\", \"children\": [], \"root\": false},\n    ]\n  \n    转换成 ->\n    {\n      id: 1,\n      children: [\n        {\n          id: 2,\n          children: [\n            {\n              id: 3,\n              children: []\n            },\n            {\n              id: 4,\n              children: []\n            }\n          ]\n        }\n      ]\n    }\n    */\n    var rootNodes = [nodes.find(function (x) { return x.root === true; })];\n    var mapChildren = function (childId) {\n        var node = nodes.find(function (x) { return x.id === childId; }) || null;\n        if (Array.isArray(node.children) && node.children.length > 0) {\n            node.children = node.children\n                .map(mapChildren)\n                .filter(function (node) { return node !== null; });\n        }\n        return node;\n    };\n    var tree = rootNodes.map(function (node) {\n        node.children = node.children\n            .map(mapChildren)\n            .filter(function (node) { return node !== null; });\n        return node;\n    });\n    return tree[0];\n}\nexport var deepEqual = function (x, y) {\n    if (x === y) {\n        return true;\n    }\n    else if (typeof x == 'object' &&\n        x != null &&\n        typeof y == 'object' &&\n        y != null) {\n        if (Object.keys(x).length != Object.keys(y).length)\n            return false;\n        for (var prop in x) {\n            if (y.hasOwnProperty(prop)) {\n                if (!deepEqual(x[prop], y[prop]))\n                    return false;\n            }\n            else\n                return false;\n        }\n        return true;\n    }\n    else\n        return false;\n};\nexport var popupCenter = function (url, _a) {\n    var _b = _a === void 0 ? { w: 585, h: 649 } : _a, w = _b.w, h = _b.h;\n    // Fixes dual-screen position                             Most browsers      Firefox\n    var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n    var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n    var width = window.innerWidth\n        ? window.innerWidth\n        : document.documentElement.clientWidth\n            ? document.documentElement.clientWidth\n            : window.screen.width;\n    var height = window.innerHeight\n        ? window.innerHeight\n        : document.documentElement.clientHeight\n            ? document.documentElement.clientHeight\n            : window.screen.height;\n    var systemZoom = width / window.screen.availWidth;\n    var left = (width - w) / 2 / systemZoom + dualScreenLeft;\n    var top = (height - h) / 2 / systemZoom + dualScreenTop;\n    var newWindow = window.open(url, '_blank', \"\\n      toolbar=no,\\n      menubar=no,\\n      scrollbars=no,\\n      resizable=no,\\n      location=no,\\n      status=no\\n      width=\" + w / systemZoom + \",\\n      height=\" + h / systemZoom + \",\\n      top=\" + top + \",\\n      left=\" + left + \"\\n      \");\n    newWindow === null || newWindow === void 0 ? void 0 : newWindow.focus();\n    return newWindow;\n};\nexport var createCssClassStyleSheet = function (className, styleSheet) {\n    var styleTag = document.createElement('style');\n    var styleText = \"\\n    .\" + className + \" {\\n      \" + styleSheet + \"\\n    }\\n  \";\n    var textNode = document.createTextNode(styleText);\n    styleTag.appendChild(textNode);\n    document.head.appendChild(styleTag);\n};\nexport var serialize = function (obj) {\n    var str = [];\n    for (var p in obj)\n        if (obj.hasOwnProperty(p)) {\n            if (obj[p] !== undefined) {\n                str.push(encodeURIComponent(p) + '=' + encodeURIComponent(obj[p]));\n            }\n        }\n    return str.join('&');\n};\nexport var convertUdv = function (data) {\n    for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n        var item = data_1[_i];\n        var dataType = item.dataType, value = item.value;\n        if (dataType === UdfDataType.Number) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Boolean) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Datetime) {\n            item.value = new Date(parseInt(value));\n        }\n        else if (dataType === UdfDataType.Object) {\n            item.value = JSON.parse(value);\n        }\n    }\n    return data;\n};\nvar isNumeric = function (str) {\n    if (typeof str != 'string')\n        return false; // we only process strings!\n    return (\n    // @ts-ignore\n    !isNaN(str) && !isNaN(parseFloat(str)) // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...\n    ); // ...and ensure strings of whitespace fail\n};\nexport var convertUdvToKeyValuePair = function (data) {\n    data = data || [];\n    for (var _i = 0, data_2 = data; _i < data_2.length; _i++) {\n        var item = data_2[_i];\n        var dataType = item.dataType, value = item.value;\n        if (dataType === UdfDataType.Number) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Boolean) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Datetime) {\n            item.value = isNumeric(value)\n                ? new Date(parseInt(value))\n                : new Date(value);\n        }\n        else if (dataType === UdfDataType.Object) {\n            item.value = JSON.parse(value);\n        }\n    }\n    var ret = {};\n    for (var _a = 0, data_3 = data; _a < data_3.length; _a++) {\n        var item = data_3[_a];\n        ret[item.key] = item.value;\n    }\n    return ret;\n};\nexport var isWechatBrowser = function () {\n    return typeof navigator !== 'undefined' &&\n        /MicroMessenger/i.test(navigator === null || navigator === void 0 ? void 0 : navigator.userAgent);\n};\nexport var isLarkBrowser = function () {\n    return typeof navigator !== 'undefined' && /Lark/i.test(navigator.userAgent);\n};\nexport var isMobileBrowser = function () {\n    return isWechatBrowser() || isLarkBrowser();\n};\nexport var formatAuthorizedResources = function (resources) {\n    return resources.map(function (resource) {\n        for (var key in resource) {\n            if (!resource[key]) {\n                delete resource[key];\n            }\n        }\n        return resource;\n    });\n};\nexport function generateUidKey(number) {\n    var map = [];\n    for (var i = 97; i < 123; i++) {\n        map.push(String.fromCharCode(i));\n    }\n    var arr = [];\n    while (number--) {\n        var rand = Math.floor(Math.random() * 16);\n        arr.push(map[rand]);\n    }\n    return arr.join('');\n}\nexport var xhrUpload = function (file, url) {\n    return new Promise(function (resolve, reject) {\n        var formData = new FormData();\n        formData.append('file', file, file instanceof Blob ? 'personal.jpeg' : undefined);\n        var xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            // 上传成功\n            if (this.readyState === 4) {\n                try {\n                    var res = JSON.parse(this.responseText);\n                    var code = res.code, message = res.message, data = res.data;\n                    if (code !== 200) {\n                        reject({\n                            code: code,\n                            message: message\n                        });\n                    }\n                    resolve(data);\n                }\n                catch (error) {\n                    var code = 500;\n                    var message = \"\\u4E0A\\u4F20\\u56FE\\u7247\\u5931\\u8D25, error = \" + error.message;\n                    reject({\n                        code: code,\n                        message: message\n                    });\n                }\n            }\n        };\n        xhr.open('POST', url);\n        xhr.send(formData);\n    });\n};\nexport function uploadFile(opts) {\n    var url = opts.url, accept = opts.accept, multiple = opts.multiple;\n    return new Promise(function (resolve, reject) {\n        var inputElem = document.createElement('input');\n        inputElem.type = 'file';\n        inputElem.accept = accept;\n        inputElem.multiple = multiple;\n        inputElem.onchange = function () {\n            var files = inputElem.files;\n            if (!multiple) {\n                var file = files[0];\n                xhrUpload(file, url)\n                    .then(function (res) { return resolve(res); })\n                    .catch(function (error) { return reject(error); });\n            }\n            else {\n                var promises = [];\n                var i = 0;\n                while (i < files.length) {\n                    promises.push(xhrUpload(files[i], url));\n                    i++;\n                }\n                Promise.all(promises)\n                    .then(function (res) { return resolve(res); })\n                    .catch(function (error) { return reject(error); });\n            }\n        };\n        inputElem.click();\n    });\n}\nexport var convertKeyValueListToObject = function (data) {\n    var ret = {};\n    for (var _i = 0, data_4 = data; _i < data_4.length; _i++) {\n        var _a = data_4[_i], key = _a.key, value = _a.value;\n        ret[key] = value;\n    }\n    return ret;\n};\nexport var convertObjectToKeyValueList = function (data) {\n    var ret = [];\n    for (var _i = 0, _a = Object.keys(data); _i < _a.length; _i++) {\n        var key = _a[_i];\n        ret.push({\n            key: key,\n            value: data[key]\n        });\n    }\n    return ret;\n};\nexport function generateRandomString(length) {\n    if (length === void 0) { length = 30; }\n    var result = '';\n    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var charactersLength = characters.length;\n    for (var i = 0; i < length; i++) {\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    }\n    return result;\n}\nexport var pickBy = function (obj, predicate) {\n    var ret = {};\n    for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\n        var key = _a[_i];\n        if (predicate(obj[key], key)) {\n            ret[key] = obj[key];\n        }\n    }\n    return ret;\n};\n//# sourceMappingURL=utils.js.map"]},"metadata":{},"sourceType":"module"}